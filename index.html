<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Sarabun', sans-serif;
        background: #f5f5f5;
        margin: 0;
        padding: 0;
    }
    header {
        background: #4CAF50;
        color: white;
        padding: 15px;
        text-align: center;
        font-size: 1.5rem;
    }
    main {
        max-width: 600px;
        margin: 20px auto;
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    input, button {
        width: 100%;
        padding: 10px;
        margin: 8px 0;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 1rem;
    }
    button {
        background: #4CAF50;
        color: white;
        cursor: pointer;
    }
    button:hover {
        background: #45a049;
    }
</style>
</head>
<body>

<header>üì¢ ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡πâ‡∏≤‡∏ô</header>

<main>
    <h3>‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å Google Sheets</h3>
    <button onclick="fetchHomework()">‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</button>
    <div id="sheetData"></div>

    <hr>

    <h3>‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏≠‡∏á (Manual)</h3>
    <input type="text" id="subject" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤">
    <input type="text" id="details" placeholder="‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î">
    <button onclick="sendManual()">‡∏™‡πà‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</button>
</main>

<script>
const sheetID = "1dObKpOKvBAOVr4B4aTWTbyoo8ElnHJqKKi4dGWiaDqk";
const sheetName = "HW";
const lineToken = "JUb7lM66V8CX1w2W/Wz+WbVOB6hLDurq8jY0jEHUuKGr4VwTOokhMGovEaYGDZUWUbIh5V7JptooJCyAkvEaUWEVUIm8asW8EzmhCdAqfmtqTUbibh4/uSXtbUVPbiC524EVWHm+6mXQirsAYejM8wdB04t89/1O/w1cDnyilFU=";
const lineGroup = "C818f3af969e10d8eeb8e13ef08647a2f";

function fetchHomework() {
    fetch(`https://opensheet.elk.sh/${sheetID}/${sheetName}`)
        .then(res => res.json())
        .then(data => {
            document.getElementById("sheetData").innerHTML = "";
            data.forEach(row => {
                sendLineMessage(row.‡∏ß‡∏¥‡∏ä‡∏≤, row.‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î);
            });
        })
        .catch(err => {
            console.error("Error fetching sheet:", err);
        });
}

function sendManual() {
    const subject = document.getElementById("subject").value;
    const details = document.getElementById("details").value;
    if (subject && details) {
        sendLineMessage(subject, details);
    } else {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");
    }
}

function sendLineMessage(subject, details) {
    const randomMessages = [
        "‡∏£‡∏µ‡∏ö‡∏ó‡∏≥‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÑ‡∏°‡πà‡∏ó‡∏±‡∏ô‡∏ô‡∏∞ üèÉ‚Äç‚ôÇÔ∏è",
        "‡∏¢‡∏±‡∏á‡∏ó‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ñ‡πâ‡∏≤‡∏•‡∏á‡∏°‡∏∑‡∏≠‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ ‚úèÔ∏è",
        "‡∏≠‡∏¢‡πà‡∏≤‡∏•‡∏∑‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ô‡∏∞ üòÜ",
        "‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏á‡∏≤‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤ ‡∏£‡∏µ‡∏ö‡∏´‡∏ô‡πà‡∏≠‡∏¢‡∏ô‡∏∞ üèÉ‚Äç‚ôÇÔ∏è",
        "‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢‡πÑ‡∏õ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° üéÆ"
    ];
    const randomText = randomMessages[Math.floor(Math.random() * randomMessages.length)];
    const message = `üö®‡πÉ‡∏Å‡∏•‡πâ‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏∞\n‡∏ß‡∏¥‡∏ä‡∏≤ : ${subject}\n‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î : ${details}\n${randomText}`;

    fetch("https://corsproxy.io/?https://api.line.me/v2/bot/message/push", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + lineToken
        },
        body: JSON.stringify({
            to: lineGroup,
            messages: [{ type: "text", text: message }]
        })
    })
    .then(res => res.json())
    .then(data => console.log("LINE API Response:", data))
    .catch(err => console.error("Error sending message:", err));
}
</script>

</body>
</html>
